<div class="container ">
    <div class="py-5 d-flex justify-content-center">
        <div class="col-md-10">
            <h1>Desafío sobre el contraste de color</h1>
        </div>
        <div class="col-md-2 p-1">
            <button type="button" class="btn btn-info" data-bs-toggle="modal" data-bs-target="#exampleModal">
                ¿Necesitas ayuda?
            </button>
        </div>
    </div>
    <div class="row py-5">
        <div class="col-md-5">
            <div class="row">
                <h5 class="text ">El botón "Iniciar sesión" en la página de inicio tiene un contraste de color
                    insuficiente, lo que dificulta su lectura para personas con discapacidad visual.
                </h5>
            </div>
            <div class="row py-2">
                <h5>Ajusta los estilos CSS para mejorar el contraste y hacer que el texto sea más legible.</h5>
            </div>
            <div class="row py-5">
                <button class="btn btn-lg btn-primary" onclick="applyCss()">Aplicar CSS</button>
            </div>
        </div>
        <div class="col-md-5 d-flex justify-content-center px-3">
            <textarea id="editor" rows="10" cols="30">
    color: white;
    background-color: lightgray;
            </textarea>
        </div>
    </div>
    <!-- Button trigger modal -->


    <!-- Modal -->
    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">Información útil</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>Según las pautas de accesibilidad WCAG 2.0, el contraste mínimo recomendado para el texto es de
                    <b>4.5:1</b>. Esto significa que el color del texto y el color de fondo deben diferir lo suficiente para
                    que las personas con discapacidad visual puedan leer el texto fácilmente.</p>

                    <p>Por ejemplo, si el color de fondo es blanco (#FFFFFF), el color del texto debe ser al menos gris
                    oscuro (#767676) para cumplir con las pautas de contraste.</p>            
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>

                </div>
            </div>
        </div>
    </div>
    <div class="row py-5  d-flex justify-content-center">
        <button class="btn btn-lg" id='login-button' style='color: white; background-color: lightgray;'>Iniciar
            sesión</button>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<script>
    var colorNames = {
        "black": "#000000",
        "white": "#ffffff",
        "red": "#ff0000",
        "lime": "#00ff00",
        "blue": "#0000ff",
        "yellow": "#ffff00",
        "cyan": "#00ffff",
        "magenta": "#ff00ff",
        "silver": "#c0c0c0",
        "gray": "#808080",
        "lightgray": "#d3d3d3",
        "maroon": "#800000",
        "olive": "#808000",
        "green": "#008000",
        "purple": "#800080",
        "teal": "#008080",
        "navy": "#000080"
    };

    function getColorHex(color) {
        if (color.indexOf('#') === 0) {
            return color;  // Ya es un color hexadecimal
        } else if (colorNames[color.toLowerCase()]) {
            return colorNames[color.toLowerCase()];  // Convertir el nombre del color a hexadecimal
        } else {
            return null;  // Color desconocido
        }
    }
    function applyCss() {
        var css = document.getElementById('editor').value;
        var loginButton = document.getElementById('login-button');
        loginButton.style = css;

        // Extrae los colores del CSS
        var colorMatch = css.match(/color:\s*(#?[A-Za-z0-9]+)/);
        var backgroundColorMatch = css.match(/background-color:\s*(#?[A-Za-z0-9]+)/);

        if (colorMatch && backgroundColorMatch) {
            // Calcula el contraste entre los colores
            var colorHex = getColorHex(colorMatch[1]);
            var backgroundColorHex = getColorHex(backgroundColorMatch[1]);

            if (colorHex && backgroundColorHex) {
                // Calcula el contraste entre los colores
                var contrast = getContrast(colorHex, backgroundColorHex);

                if (contrast >= 4.5) {
                    alert('El contraste es suficiente');
                } else {
                    alert('El contraste no es suficiente');
                }
            } else {
                alert('Uno de los colores no se reconoce');
            }
        } else {
            alert('No se pudo encontrar el color o el color de fondo en el CSS');
        }
    }

    function getLuminance(r, g, b) {
        var a = [r, g, b].map(function (v) {
            v /= 255;
            return v <= 0.03928
                ? v / 12.92
                : Math.pow((v + 0.055) / 1.055, 2.4);
        });
        return a[0] * 0.2126 + a[1] * 0.7152 + a[2] * 0.0722;
    }

    function getContrast(hexcolor1, hexcolor2) {
        var rgb1 = hexToRgb(hexcolor1);
        var rgb2 = hexToRgb(hexcolor2);
        var luminance1 = getLuminance(rgb1.r, rgb1.g, rgb1.b);
        var luminance2 = getLuminance(rgb2.r, rgb2.g, rgb2.b);
        var contrast = (Math.max(luminance1, luminance2) + 0.05) / (Math.min(luminance1, luminance2) + 0.05);
        return contrast;
    }

    function hexToRgb(hex) {
        var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
        return result ? {
            r: parseInt(result[1], 16),
            g: parseInt(result[2], 16),
            b: parseInt(result[3], 16)
        } : null;
    }
</script>